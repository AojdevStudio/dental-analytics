# Story 3.4 Readiness Checklist - Frontend Migration

**Generated by:** Murat (Master Test Architect)
**Date:** 2025-10-13
**Prerequisite:** Story 3.3 Complete ‚úÖ

---

## Executive Summary

Story 3.4 will migrate the frontend layer (`apps/frontend/`) from dictionary-based data structures to Pydantic models. This checklist ensures a smooth transition by validating prerequisites, establishing baselines, and identifying potential blockers.

---

## ‚úÖ Prerequisites Validation

### Story 3.3 Completion
- [x] **Phase 1 backend migration complete** (Story 3.3 status: ‚úÖ Ready for Review)
- [x] **Quality gate passed** (PASS_WITH_CONCERNS - frontend deferred to Story 3.4)
- [x] **All backend tests passing** (337/342 = 98.5%)
- [x] **Core coverage ‚â•95%** (achieved)
- [x] **TypedDict elimination complete** (13/13 deleted, 4 retained for Phase 3)
- [x] **Documentation updated** (CLAUDE.md, roadmap, completion summary)

### Git Repository State
- [ ] **Feature branch up to date**:
  ```bash
  git checkout feature/phase-1-pydantic-models
  git pull origin feature/phase-1-pydantic-models
  ```
- [ ] **No uncommitted changes**:
  ```bash
  git status
  # Expected: "working tree clean"
  ```
- [ ] **Story 3.3 commit present**:
  ```bash
  git log --oneline -1 | grep "Story 3.3\|phase-1\|TypedDict"
  ```

### Environment Setup
- [ ] **Dependencies installed**:
  ```bash
  uv sync
  ```
- [ ] **Streamlit running locally**:
  ```bash
  uv run streamlit run apps/frontend/app.py
  # Dashboard should load at http://localhost:8501
  ```
- [ ] **All quality tools available**:
  ```bash
  uv run pytest --version
  uv run mypy --version
  uv run ruff --version
  ```

---

## üìä Baseline Establishment

### Frontend Test Coverage Baseline
- [ ] **Run frontend tests**:
  ```bash
  uv run pytest tests/test_plotly_charts.py -v --tb=short
  ```
  - [ ] Document current pass/fail count: ___ / ___
  - [ ] Document current failures: ___

- [ ] **Check for frontend-specific test files**:
  ```bash
  ls tests/ | grep -i "frontend\|streamlit\|plotly\|chart"
  ```
  - [ ] Document files found: ___

### Frontend Code Inventory
- [ ] **Identify frontend files requiring migration**:
  ```bash
  ls apps/frontend/
  ```
  - [ ] Document files: ___

- [ ] **Search for dictionary access patterns**:
  ```bash
  grep -r "result\[" apps/frontend/ --include="*.py"
  grep -r "data\[" apps/frontend/ --include="*.py"
  grep -r "\.get(" apps/frontend/ --include="*.py"
  ```
  - [ ] Document count of dictionary accesses: ___

- [ ] **Search for TypedDict imports**:
  ```bash
  grep -r "from apps.backend.types import" apps/frontend/ --include="*.py"
  ```
  - [ ] Document imports found: ___

### Dashboard Functionality Baseline
- [ ] **Manual smoke test** (document screenshots/results):
  1. [ ] Dashboard loads without errors
  2. [ ] Baytown location displays all 5 KPIs
  3. [ ] Humble location displays all 5 KPIs
  4. [ ] Location switcher works correctly
  5. [ ] All metrics show numerical values (not "Data Unavailable")
  6. [ ] No console errors in terminal

- [ ] **Check for Pydantic model usage**:
  ```bash
  grep -r "KPIResponse\|ProcessedChartData\|TimeSeriesData" apps/frontend/ --include="*.py"
  ```
  - [ ] Document current Pydantic usage: ___

---

## üéØ Story 3.4 Scope Definition

### In Scope (Frontend Migration)
- [ ] **apps/frontend/app.py**: Update to use Pydantic attribute access
- [ ] **apps/frontend/chart_production.py**: Update chart functions for Pydantic models
- [ ] **apps/frontend/*.py**: All frontend modules using dictionaries
- [ ] **tests/test_plotly_charts.py**: Fix 4 failing tests (frontend compatibility)
- [ ] **Type hints**: Add Pydantic type hints to frontend functions

### Out of Scope (Deferred)
- [ ] **apps/backend/historical_data.py**: Phase 3 (Historical Analysis Migration)
- [ ] **Legacy test files (.phase3.skip)**: Phase 3 re-enablement
- [ ] **Advanced charting features**: Future enhancements (post-Phase 1)

---

## üö® Potential Blockers Identification

### Technical Blockers
- [ ] **Streamlit compatibility with Pydantic**:
  - [ ] Research: Does Streamlit natively support Pydantic models?
  - [ ] Test: Can `st.metric()` accept Pydantic model attributes?
  - [ ] Workaround: May need `.model_dump()` for some Streamlit components

- [ ] **Plotly chart compatibility**:
  - [ ] Research: Do Plotly chart functions accept Pydantic models?
  - [ ] Test: Can `go.Scatter()` use Pydantic `TimeSeriesData` attributes?
  - [ ] Workaround: May need manual attribute extraction

- [ ] **Session state serialization**:
  - [ ] Research: Can Streamlit session state store Pydantic models?
  - [ ] Test: Does `st.session_state['data'] = pydantic_model` work?
  - [ ] Workaround: May need `.model_dump()` for serialization

### Dependency Blockers
- [ ] **Check for missing Pydantic models**:
  - [ ] Verify `core/models/chart_models.py` has all required models
  - [ ] Verify `core/models/kpi_models.py` has `KPIResponse` and `KPIValue`
  - [ ] Check if frontend needs additional models not yet created

### Documentation Blockers
- [ ] **Frontend architecture documentation**:
  - [ ] Review `docs/architecture/fullstack-architecture.md` for frontend details
  - [ ] Check if frontend data flow is documented
  - [ ] Identify gaps in frontend type documentation

---

## üìù Story 3.4 Acceptance Criteria Preview

### Expected ACs (Draft)
1. [ ] `apps/frontend/app.py` updated to use Pydantic attribute access
2. [ ] `apps/frontend/chart_production.py` updated for Pydantic models
3. [ ] All frontend modules use Pydantic type hints
4. [ ] `tests/test_plotly_charts.py` all 8 tests passing
5. [ ] Dashboard smoke test passes (all locations, all KPIs)
6. [ ] Zero MyPy errors in `apps/frontend/`
7. [ ] Zero Ruff warnings in `apps/frontend/`
8. [ ] Frontend test coverage ‚â•80% (if applicable)
9. [ ] CLAUDE.md updated with frontend migration status
10. [ ] Migration summary documented

---

## üî¨ Risk Assessment

### High-Risk Areas
1. **Streamlit Session State**:
   - Risk: Pydantic models may not serialize correctly
   - Mitigation: Test early; use `.model_dump()` if needed

2. **Plotly Chart Functions**:
   - Risk: Chart functions may require dictionaries, not Pydantic models
   - Mitigation: Review Plotly docs; extract attributes manually if needed

3. **Breaking Changes**:
   - Risk: Frontend updates may break dashboard functionality
   - Mitigation: Comprehensive smoke testing; rollback plan ready

### Medium-Risk Areas
1. **Type Hint Complexity**:
   - Risk: Frontend may have complex nested types
   - Mitigation: Leverage existing Pydantic models; avoid duplication

2. **Test Coverage Gaps**:
   - Risk: Frontend may have low test coverage baseline
   - Mitigation: Document baseline; set realistic coverage targets

### Low-Risk Areas
1. **Backend Integration**:
   - Risk: Backend already provides Pydantic models
   - Mitigation: Frontend just needs to consume them correctly

---

## üõ†Ô∏è Pre-Story 3.4 Actions

### Required Before Starting Story 3.4
1. [ ] **Merge Story 3.3 to main** (or confirm feature branch is stable)
2. [ ] **Run full test suite** to confirm baseline:
   ```bash
   uv run pytest --cov=apps --cov=core --cov=services --cov-report=term-missing
   ```
3. [ ] **Document dashboard functionality** (screenshots or video)
4. [ ] **Review Streamlit + Pydantic compatibility** (research/testing)
5. [ ] **Review Plotly + Pydantic compatibility** (research/testing)

### Optional (Recommended)
1. [ ] **Create Story 3.4 markdown file**:
   ```bash
   cp docs/stories/story-3.3-testing-cleanup-documentation.md docs/stories/story-3.4-frontend-migration.md
   # Update story details
   ```
2. [ ] **Load Developer Agent** (Amelia) to start Story 3.4
3. [ ] **Generate Story 3.4 Context XML** using Scrum Master Agent (Bob)

---

## üìã Story 3.4 Execution Checklist Preview

### Phase 1: Planning (30 minutes)
- [ ] Load Story 3.4 context
- [ ] Review Pydantic models in `core/models/`
- [ ] Identify all frontend files requiring updates
- [ ] Create detailed implementation plan

### Phase 2: Implementation (2-3 hours)
- [ ] Update `apps/frontend/app.py` (main dashboard)
- [ ] Update `apps/frontend/chart_production.py` (chart functions)
- [ ] Update any other frontend modules
- [ ] Add Pydantic type hints throughout

### Phase 3: Testing (1-2 hours)
- [ ] Fix `tests/test_plotly_charts.py` (4 failing tests)
- [ ] Run full frontend test suite
- [ ] Manual dashboard smoke test (both locations)
- [ ] Verify no console errors

### Phase 4: Quality Gates (1 hour)
- [ ] Run MyPy on `apps/frontend/`
- [ ] Run Ruff on `apps/frontend/`
- [ ] Run Black formatting
- [ ] Full test suite passes

### Phase 5: Documentation (30 minutes)
- [ ] Update CLAUDE.md with frontend status
- [ ] Create frontend migration summary
- [ ] Update story markdown file

### Phase 6: Completion (15 minutes)
- [ ] Git commit all changes
- [ ] Push feature branch
- [ ] Mark Story 3.4 as Done

---

## ‚úÖ Readiness Checklist Summary

**Prerequisites:**
- [x] Story 3.3 complete
- [x] Quality gate passed
- [ ] Git repository clean
- [ ] Environment setup validated

**Baselines:**
- [ ] Frontend test coverage documented
- [ ] Frontend code inventory complete
- [ ] Dashboard functionality verified

**Blockers:**
- [ ] Technical blockers identified and mitigated
- [ ] Dependency blockers resolved
- [ ] Documentation gaps filled

**Risk Assessment:**
- [ ] High-risk areas identified with mitigation
- [ ] Medium/low-risk areas documented

**Pre-Story Actions:**
- [ ] All required actions completed
- [ ] Optional actions considered

---

## üéØ Go/No-Go Decision

**Criteria for "GO" Decision:**
- [x] Story 3.3 complete (‚úÖ)
- [ ] All prerequisites validated (checklist above)
- [ ] No critical blockers identified
- [ ] Baseline documentation complete
- [ ] Risk mitigation strategies in place

**Current Status:** ‚è∏Ô∏è PENDING CHECKLIST COMPLETION

**Recommendation:** *tweet* Complete the checklist items above, then Story 3.4 is ready to start!

---

## üìû Support & Escalation

**Questions or Blockers?**
- **Technical Issues:** Review `docs/architecture/backend/testing-strategy.md`
- **Pydantic Questions:** Review `core/models/*.py` for examples
- **Agent Support:** Load Developer Agent (Amelia) or Scrum Master Agent (Bob)

---

*Generated by Murat (Master Test Architect) - 2025-10-13*
